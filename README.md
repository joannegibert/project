# SEIRD Modelling of Highly Pathogenic Avian Influenza (HPAI)

## Project description

This project implements a SEIRD (Susceptible-Exposed-Infected-Recovered-Deceased) epidemiological model to simulate HPAI dynamics. The core numerical simulation is developed in C for computational efficiency, solving the system of differential equations for nine scenarios.

The entire workflow is automated using MATLAB, which serves as a wrapper to:
1. Execute the compiled C program for various parameter sets.
2. Process the generated time-series data.
3. Compute key epidemiological metrics.
4. Generate comprehensive visualizations for comparative analysis.

### Input files

**`data/parameters.csv`**: a CSV file defining the epidemiological parameters for **9 distinct scenarios**.
  - **Format**: Each row corresponds to one scenario.
  - **Columns**: 
    - `beta` (transmission rate $\beta$)
    - `gamma` (recovery rate $\gamma$)
    - `mu` (mortality rate $\mu$)
    - `N` (total population size $N$)
    - `sigma` (incubation rate $\sigma$)
  - The C program reads these 9 rows sequentially to generate the corresponding outputs (from Scenario 1 to Scenario 9).

### Output files
All simulation results and visualizations are automatically generated in the `results/` directory:

1. **Simulation data (CSV)**:
   - `scenario_1.csv` to `scenario_9.csv`: Time-series data generated by the C program for each of the 9 scenarios.
     - **Columns**: `time` (from 0 to 2000 days with a time step of 0.1 days), `S` (Susceptible), `E` (Exposed), `I` (Infected), `R` (Recovered), `D` (Deceased).

2. **Summary metrics**:
   - `summary_results.csv`: a table computed by MATLAB containing key metrics for all scenarios:
     - Peak infected.
     - Total deaths.
     - Time to epidemic decline (days until $R_{eff} < 1$).
     - Time to epidemic end (days until the end of the epidemic).

3. **Visualizations**:
   - `Figure_1.png`: 3×3 grid showing S, E, I, R, D dynamics for all 9 scenarios.
   - `Figure_2.png`: detailed full-scale trajectory for Scenario 4.
   - `Figure_3.png`: evolution of the effective reproduction number $R_{eff}(t)$ over time.
   - `Figure_4.png`: bar chart comparing epidemic timing metrics (Time to Decline and Time to End).
   - `Figure_5.png`: bar chart comparing population impact metrics (Peak infected and Total deaths).
  
### Report

The final report is placed in "docs/" as "report.pdf".

## Running the program

### Dependencies

This project is designed to run in a standard Unix-like environment (Linux/macOS) or Windows, specifically compatible with the **SIE Linux VDI**.

**Required software:**
- **C Compiler**: `gcc` (GNU Compiler Collection) or any standard C compiler.
- **MATLAB**: Version **R2025a**.
  - Note: The code uses standard MATLAB functions and should remain compatible with older versions (e.g., R2023b+).
  - Required toolboxes: None.

**System requirements:**
- Operating System: Linux, macOS, or Windows.
- No external libraries are required.

### Build

To compile the C program (called `seird_model.c`), open a terminal in the project directory and run:

`gcc src/seird_model.c -o bin/seird_model`

This creates the executable in the `bin/` directory.

### Execute

The entire workflow (simulation + visualization) is automated via MATLAB in a script called `seird_plot.m`.
A shell script named `run.sh` is provided at the project directory to launch the full workflow.

From the terminal of the project directory, make the script executable and run:

`chmod u+x run.sh`

`./run.sh`

This script:
- calls the C executable `bin/seird_model`;
- generates per‑scenario output files in `results/scenario_*.csv`;
- computes the summary table `results/summary_results.csv`;
- saves the five figures in the `results/` directory.
   
## Contributors

Zoé Jacob and Joanne Gibert. 

## Acknowledgments

### Data sources

We only use a single CSV file of parameters as input. The choice and justification of these parameter values are described in detail in the project report.

### Code

Large language models (ChatGPT and Perplexity AI) were used occasionally to debug C and MATLAB code when it did not run as expected, and to suggest initial versions of some code comments and documentation text; all such suggestions were manually reviewed, corrected, and adapted before inclusion. 

For the mathematical formulation and MATLAB implementation, the primary references were the MathWorks documentation. The C implementation relied on online tutorials for structures and file I/O, in particular W3Schools:

- C structs: <https://www.w3schools.com/c/c_structs.php>  
- Read file: <https://www.w3schools.com/c/c_files_read.php>  
- Read line from file (`fgets`): <https://www.w3schools.com/c/ref_stdio_fgets.php> 
- Extract data from line (`sscanf`): <https://www.w3schools.com/c/ref_stdio_sscanf.php>  
- Write a formatted string (`sprintf`): <https://www.w3schools.com/c/ref_stdio_sprintf.php>  

The Euler method and its application to epidemic models were based on the following resources:

- Duke SIR module: <https://sites.math.duke.edu/education/ccp/materials/diffcalc/sir/sir3.html>  
- Course website: <https://stakahama.gitlab.io/sie-eng270/exercise_CFC.html#details>  
- Comparison of Euler and 4th‑order Runge–Kutta methods for epidemiological models:  
<https://www.researchgate.net/publication/350066021_Comparison_of_Numerical_Simulation_of_Epidemiological_Model_between_Euler_Method_with_4th_Order_Runge_Kutta_Method>




























